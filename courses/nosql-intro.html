<!DOCTYPE html>
<html>
    <head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Introduction à NoSQL</title>

		<link rel="stylesheet" href="../css/slides-reset.css">
		<link rel="stylesheet" href="../css/slides.css">
		<link rel="stylesheet" href="../css/slides-theme.css" id="theme">
		<link rel="stylesheet" href="../css/slides-code.css" id="highlight-theme">

		<style>
			.reveal .slides section section {
				margin-top: 1.5em; /* margin for upper section title */
			}

			.reveal .slides .note {
				padding: 0.5em;
				font-size: 0.5em;
				color: peru;
				background-color: moccasin;
			}

			.reveal .slides .note .highlight {
				color: brown;
			}
			
			.reveal .slides table {
				font-size: 0.65em;
			}
			
			.reveal .slides table.t {
				font-size: 0.75em;
			}
			
			.reveal .slides table.t th {
				background-color: moccasin;
			}
			
			.reveal .slides table.t td {
				background-color: linen;
			}

            .reveal .slides table.plain {
                border: 0px;
				font-size: 1em;
            }

            .reveal .slides table.plain th {
                text-align: center;
                border: 0px;
            }

            .reveal .slides table.plain td {
                text-align: center;
                border: 0px;
            }

            .reveal .slides table.plain img.thumbnail {
                margin: 20px;
                max-height: 100px;
            }
			
			.reveal .slides .phi {
				text-align: left;
			}
			
			.reveal .slides .sql {
				text-align: left;
			}
			
			.reveal .slides .json {
				text-align: left;
			}
			
			.reveal .slides .cypher {
				text-align: left;
			}
			
			.reveal .slides .gremlin {
				text-align: left;
			}
			
			.reveal .slides .sparql {
				text-align: left;
			}

            .reveal .slides .var {
                color: darkmagenta;
                font-weight: bold;
            }

            .reveal .slides .comment {
                color: lightblue;
            }

            .reveal .slides .param {
                color: lightgray;
            }

            .reveal .slides .string {
                color: peru;
            }

            .reveal .slides .nb {
                color: skyblue;
            }

			.reveal .slides figcaption {
				color: gray;
				font-size: 0.5em;
			}

			.reveal .slides figure img {
				max-height: 8em; /* FIXME should be a percent of total height */
			}

            .reveal .slides caption {
                color: gray;
                font-size: 0.5em;
            }

            .reveal .slides mark {
                background-color: moccasin;
            }
		</style>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>Introduction à <span style="text-shadow: lightgrey 5px 5px;">No</span>SQL</h1>
                    <p><a href="https://www.vcharpenay.link/">Victor Charpenay</a></p>
                </section>
                <section>
                    <!-- background source: https://www.youtube.com/watch?v=-bpvvOBV-q0 -->
                    <section data-background-image="../misc/nosql-intro/dr-no.png" data-background-opacity="0.25" data-auto-animate>
                        <p>Que veut dire NoSQL ?</p>
                        <ol>
                            <li class="fragment">No structure QL</li>
                            <li class="fragment">Not SQL</li>
                            <li class="fragment">Not only SQL</li>
                            <li class="fragment">New SQL<span style="font-size: 0.5em;"> (en danois)</span></li>
                        </ol>
                    </section>
                    <section data-background-image="../misc/nosql-intro/dr-no.png" data-background-opacity="0.25" data-auto-animate>
                        <p>Que veut dire NoSQL ?</p>
                        <ol>
                            <li>No structure QL</li>
                            <li>Not SQL</li>
                            <li style="text-decoration: underline;">Not only SQL</li>
                            <li>New SQL<span style="font-size: 0.5em;"> (en danois)</span></li>
                        </ol>
                    </section>
                </section>
                <section>
                    <h4>SQL (Rappel)</h4>
                    <section>
                        <p class="fragment">SQL signifie<br><mark>Structured Query Language</mark></p>
                        <p class="fragment">SQL est un langage <mark>déclaratif</mark> de manipulation de données <mark>relationnelles</mark>.</p>
                    </section>
                    <section>
                        <p class="sql">
                            CREATE TABLE <span class="param">table</span>(<span class="param">attribut(s)</span>) ;<br><br>
                            INSERT INTO <span class="param">table</span> VALUES <span class="param">tuple</span> ;
                        </p>
                    </section>
                    <section>
                        <table class="t" style="float: left;">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Nom</th>
                                    <th>Taille</th>
                                    <th>Poids</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.9kg</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Salamèche</td>
                                    <td>0.6m</td>
                                    <td>8.5kg</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Carapuce</td>
                                    <td>0.5m</td>
                                    <td>9.0kg</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Pikachu</td>
                                    <td>0.4m</td>
                                    <td>6.0kg</td>
                                </tr>
                                <tr>
                                    <td>#052</td>
                                    <td>Miaouss</td>
                                    <td>0.4m</td>
                                    <td>4.2kg</td>
                                </tr>
                            </tbody>
                        </table>

                        <table class="t">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Plante</td>
                                </tr>
                                <tr>
                                    <td>#001</td>
                                    <td>Poison</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Feu</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Eau</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Électrik</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section>
                        <p class="phi">
                            <span class="var">Pokémon</span> = {<br>
                            &nbsp;&nbsp;(#001, Bulbizarre, 0.7, 6.9),<br>
                            &nbsp;&nbsp;(#004, Salamèche, 0.6, 8.5),<br>
                            &nbsp;&nbsp;(#007, Carapuce, 0.5, 9.0),<br>
                            &nbsp;&nbsp;(#025, Pikachu, 0.4, 6.0),<br>
                            &nbsp;&nbsp;(#052, Miaouss, 0.4, 4.2)<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p class="sql">
                            SELECT <span class="param">attribut(s)</span><br>
                            FROM <span class="param">table(s)</span><br>
                            WHERE <span class="param">condition(s)</span> ;
                        </p>
                    </section>
                    <section>
                        <p>(Q<sub>1</sub>) Quel est le nom des Pokémon de type feu ?</p>
                        <p class="fragment sql">
                            SELECT <span class="var">Nom</span><br>
                            FROM <span class="var">Pokémon</span> AS <span class="var">P</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="var">Pokémon Type</span> AS <span class="var">PT</span><br>
                            WHERE <span class="var">P</span>.<span class="var">Rang</span> = <span class="var">PT</span>.<span class="var">Rang</span> AND<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="var">Type</span> = Feu ;
                        </p>
                    </section>
                    <section>
                        <p>Un schéma de base de données peut être soumis à des <mark>dépendance fonctionnelle</mark>.</p>
                        <p class="fragment">Une <mark>clé primaire</mark> est un attribut duquel dépend fonctionnellement tous les attributs d'une table.</p>
                    </section>
                    <section>
                        <p>Le rang d'un Pokémon détermine son nom, sa taille et son poids.</p>
                        <p class="fragment"><span class="var">Rang</span> → (<span class="var">Nom</span>, <span class="var">Taille</span>, <span class="var">Poids</span>)</p>
                    </section>
                    <section>
                        <p>Un schéma <mark>normalisé</mark> garantit l'absence d'incohérences dans les données.</p>
                    </section>
                    <section>
                        <table class="t">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Nom</th>
                                    <th>Taille</th>
                                    <th>Poids</th>
                                    <th>Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.9kg</td>
                                    <td>Plante</td>
                                </tr>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.8kg</td>
                                    <td>Poison</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Salamèche</td>
                                    <td>0.6m</td>
                                    <td>8.5kg</td>
                                    <td>Feu</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Carapuce</td>
                                    <td>0.5m</td>
                                    <td>9.0kg</td>
                                    <td>Eau</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Pikachu</td>
                                    <td>0.4m</td>
                                    <td>6.0kg</td>
                                    <td>Électrik</td>
                                </tr>
                                <tr>
                                    <td>#052</td>
                                    <td>Miaouss</td>
                                    <td>0.4m</td>
                                    <td>4.2kg</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section>
                        <p>Avec un schéma <mark>dénormalisé</mark>, la table ci-dessus ne respecte pas la dépendance fonctionnelle</p>
                        <p><span class="var">Rang</span> → <span class="var">Poids</span></p>
                    </section>
                    <section>
                        <p>Le fondement théorique d'SQL est l'<mark>algèbre relationnelle</mark>.</p>
                        <p class="fragment">Une table (SQL) équivaut à une <mark>relation</mark> en algèbre relationnelle.</p>
                    </section>
                    <section>
                        <p>Les (principaux) opérateurs algébriques autorisés sur des relations sont:</p>
                        <ul>
                            <li class="fragment"><mark>sélection</mark> (σ)</li>
                            <li class="fragment"><mark>projection</mark> (π)</li>
                            <li class="fragment"><mark>jointure</mark> (⋈)</li>
                            <li class="fragment"><mark>renommage</mark> (𝛿)</li>
                        </ul>
                    </section>
                    <section>
                        <p>Une requête SQL correspond à une <mark>opération algébrique</mark> sur une ou plusieurs relations.</p>
                        <p class="fragment">
                            Q<sub>1</sub> ≡ π<sub><span class="var">Nom</span></sub> ( σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">P</span> ⋈ <span class="var">PT</span> ) )
                        </p>
                    </section>
                    <section>
                        <p>Une requête peut être optimisée grâce aux <mark>identités algébriques</mark> des opérateurs.</p>
                        <p class="fragment">
                            π<sub><span class="var">Nom</span></sub> ( σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">P</span> ⋈ <span class="var">PT</span> ) )
                            <br>↓<br>
                            π<sub><span class="var">Nom</span></sub> ( <span class="var">P</span> ⋈ σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">PT</span> ) )
                        </p>
                    </section>
                    <section>
                        <p>Une requête peut aussi être optimisée grâce à des <mark>index</mark> sur les tables.</p>
                        <table class="fragment">
                            <thead>
                                <tr>
                                    <th>Type d'index</th>
                                    <th>Complexité</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>table de hachage</td>
                                    <td>recherche d'élément en O(1)</td>
                                </tr>
                                <tr>
                                    <td>B-arbre</td>
                                    <td>recherche d'élément en O(log<sub>2</sub>(n))</td>
                                </tr>
                            </tbody>
                            <caption>Structures d'index et complexité pour la recherche d'élément</caption>
                        </table>
                    </section>
                </section>
                <section>
                    <h4>Pourquoi "pas seulement" SQL ?</h4>
                    <section>
                        <p>
                            SQL est de loin le langage de requête le plus utilisé dans les SI.
                            
                        </p>
                        <p class="fragment note">
                            En 2020, <a href="https://en.wikipedia.org/wiki/Oracle_Corporation">Oracle</a> avait un chiffre d'affaire 100 fois plus élevé que <a href="https://en.wikipedia.org/wiki/MongoDB_Inc.">MongoDB</a>, le principal fournisseur de solutions NoSQL.
                        </p>
                    </section>
                    <section>
                        <p>
                            Le modèle relationnel est de loin le plus établi en informatique théorique.
                        </p>
                        <p class="fragment note">
                            Les travaux <a href="https://en.wikipedia.org/wiki/List_of_important_publications_in_computer_science#Databases">les plus significatifs en base de données</a> sont ceux de E. F. Codd, le concepteur du modèle relationnel.
                        </p>
                    </section>
                    <section>
                        <p>Mais...</p>
                    </section>
                    <section>
                        <figure>
                            <svg style="width: 75%;" version="1.1" viewBox="0 0 1024 683">
                                <image href="../misc/nosql-intro/nosql-debrief-2009.jpg"/>
                                <text class="fragment" style="fill: white; stroke: black; text-align: center; font-weight: bold; font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif; font-size: 80px;">
                                    <tspan x="20" y="120" textLength="800">RELATIONAL DATABASES</tspan>
                                    <tspan x="20" y="200" textLength="800">GIVE YOU TOO MUCH</tspan>
                                </text>
                                <g class="fragment">
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="30" y="400" />
                                        <image href="../misc/nosql-intro/logo-hbase.png" width="300" height="100" x="30" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="360" y="400" />
                                        <image href="../misc/nosql-intro/logo-dynamodb.png" width="300" height="100" x="360" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="690" y="400" />
                                        <image href="../misc/nosql-intro/logo-google-cloud.png" width="300" height="100" x="690" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="30" y="520" />
                                        <image href="../misc/nosql-intro/logo-couchdb.png" width="300" height="100" x="30" y="520" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="360" y="520" />
                                        <image href="../misc/nosql-intro/logo-mongodb.png" width="300" height="100" x="360" y="520" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="690" y="520" />
                                        <image href="../misc/nosql-intro/logo-cassandra.png" width="300" height="100" x="690" y="520" />
                                    </g>
                                </g>
                            </svg>
                            <figcaption><a href="https://web.archive.org/web/20090927183845/http://blog.oskarsson.nu/2009/06/nosql-debrief.html">NoSQL community meeting</a>, San Francisco, 2009</figcaption>
                        </figure>
                    </section>
                    <section>
                        <q>
                            Relational databases force you to <mark>twist your object data</mark> to fit a RDBMS [relational database management system].
                        </q>
                    </section>
                    <section>
                        <q>
                            Web 2.0 companies can take chances and they need <mark>scalability</mark>.
                        </q>
                    </section>
                    <section>
                        <q>
                            Oracle would tell you that with the right degree of hardware and the right configuration, you can achieve the same scalability. But <mark>at what cost</mark>?
                        </q>
                    </section>
                    <section>
                        <p>
                            Les premières bases de données NoSQL ont été conçues pour être :
                        </p>
                        <ul>
                            <li class="fragment">massivement <mark>distribuées</mark></li>
                            <li class="fragment">sur des serveurs <mark>abordables</mark></li>
                            <li class="fragment">et <mark>accessibles à distance</mark></li>
                        </ul>
                    </section>
                    <section>
                        <p>SQL garantit la cohérence des données (si leur schéma est normalisé).</p>
                        <p class="fragment">
                            Or, toute base de données <mark>distribuée</mark> ne peut être en même temps<br>
                            <mark>cohérente</mark> et <mark>accessible</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            C'est le théorème <b>CAP</b>.
                        </p>
                    </section>
                    <section>
                        <ul>
                            <li>
                                <span style="text-decoration: underline;">C</span>ohérence<br>
                                <span style="color: lightgray; font-size: 0.65em;">Résultat de requête jamais obsolète.</span>
                            </li>
                            <li class="fragment">
                                <span style="text-decoration: underline;">A</span>ccessibilité<br>
                                <span style="color: lightgray; font-size: 0.65em;">Résultat de requête toujours donné.</span>
                            </li>
                            <li class="fragment">
                                <span style="text-decoration: underline;">P</span>artitionnement tolérant aux fautes<br>
                                <span style="color: lightgray; font-size: 0.65em;">Résultat de requête parfois égal à une erreur.</span>
                            </li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            Les bases de données NoSQL utilisent des <mark>schémas dénormalisés</mark> pour garantir un accès rapide et à distance aux données.
                        </p>
                    </section>
                    <!-- TODO ACID vs. BASE -->
                    <section>
                        <p>
                            Par extension, d'autres bases de données ont été labelisées «&nbsp;NoSQL&nbsp;».
                        </p>
                        <p class="fragment">
                            Ces bases de données offrent des <mark>langages de requête alternatifs</mark> à SQL.
                        </p>
                    </section>
                    <section>
                        <p>
                            Plusieurs modèles de données NoSQL (co)existent.
                        </p>
                    </section>
                    <section>
                        <table>
                            <thead>
                                <tr>
                                    <th>Déf. de NoSQL</th>
                                    <th>Modèle de données</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3">stricte</td>
                                    <td>paire clé-valeur</td>
                                </tr>
                                <tr>
                                    <td>document</td>
                                </tr>
                                <tr>
                                    <td>à colonne extensible (ou «&nbsp;large&nbsp;»)</td>
                                </tr>
                                <tr>
                                    <td rowspan="2">étendue</td>
                                    <td>en graphe</td>
                                </tr>
                                <tr>
                                    <td>RDF <span style="font-size: 0.5em;">(Resource Description Framework)</span></td>
                                </tr>
                            </tbody>
                            <caption>Modèles de données NoSQL (définition stricte et étendue)</caption>
                        </table>
                    </section>
                </section>
                <section>
                    <h4><span style="text-decoration: line-through;">Forme normale</span> et <span style="text-decoration: line-through;">schéma</span></h4>
                    <section>
                        <p>
                            La <mark>normalisation</mark> d'une base de données tend à <mark>multiplier</mark> les tables et les <mark>jointures</mark>.
                        </p>
                        <p class="fragment">
                            Souvent, une application nécessite de toujours requêter <mark>plusieurs tables simultanément</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Par exemple, l'interface graphique du Pokédex indique toujours le(s) type(s) d'un Pokémon à côté de son nom.
                        </p>
                        <p class="fragment">
                            Une requête qui joint <span class="var">Pokémon</span> et <span class="var">PokémonType</span> prend <mark>1,66 fois plus de temps</mark> qu'une simple requête sur <span class="var">Pokémon</span>.
                        </p>
                        <!-- pokemon: 15ms, pokemon x pokemon_types: 25ms (with warm cache) -->
                    </section>
                    <section>
                        <p>
                            Une solution simple pour <mark>optimiser</mark> le requêtage du Pokédex est de le <mark>dénormaliser</mark> et de ne matérialiser que la table <span class="var">Pokémon</span> ⋈ <span class="var">PokémonType</span>.
                        </p>
                    </section>
                    <section>
                        <p>
                            C'est par exemple ce que fit la plate-forme <a href="https://en.wikipedia.org/wiki/Digg">Digg</a> en 2009 pour gérer son réseau social aux <mark>millions</mark> de relations et aux <mark>centaines de millions</mark> de pages web référencées.
                        </p>
                        <p class="note fragment">
                            Cf <a href="http://www.25hoursaday.com/weblog/2009/09/10/BuildingScalableDatabasesDenormalizationTheNoSQLMovementAndDigg.aspx"><em>Building Scalable Databases: Denormalization, the NoSQL Movement and Digg</em></a>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Digg est même allée plus loin&hellip;
                        </p>
                        <p class="fragment">
                            Dès lors que les tables sont <mark>dénormalisées</mark>, à quoi sert-il d'avoir un <mark>schéma</mark> ?
                        </p>
                    </section>
                    <section>
                        <q>
                            After some deliberation, we decided to implement a <mark>"schema-less" storage system on top of MySQL</mark> rather than use a completely new storage system.
                        </q>
                    </section>
                    <section data-background-color="moccasin">
                        <p>
                            Quel serait le (méta-)schéma d'une base de données sans schéma ?
                        </p>
                    </section>
                    <section>
                        <p>
                            S<sub><span class="var" title="Mother Of All Tables">MOAT</span></sub> = {<span class="var">Table</span>, <span class="var">Tuple</span>, <span class="var">Attr</span>, <span class="var">Value</span>}
                        </p>
                        <p class="fragment">
                            (<span class="var">Table</span>, <span class="var">Tuple</span>, <span class="var">Attr</span>) → <span class="var">Value</span> 
                        </p>
                    </section>
                    <section>
                        <p class="phi">
                            <span class="var">MOAT</span> = {<br>
                            &nbsp;&nbsp;(Pokémon, 1, Rang, #001),<br>
                            &nbsp;&nbsp;(Pokémon, 1, Nom, Bulbizarre),<br>
                            &nbsp;&nbsp;(Pokémon, 1, Taille, 0.7),<br>
                            &nbsp;&nbsp;(Pokémon, 1, Poids, 6.9),<br>
                            &nbsp;&nbsp;(PokémonType, 1, Rang, #001),<br>
                            &nbsp;&nbsp;(PokémonType, 1, Type, Plante),<br>
                            &nbsp;&nbsp;&hellip;<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            Ce choix technologique <span style="color: lightgray;">(douteux)</span> a duré moins d'un an pour Digg.
                        </p>
                        <p class="fragment">
                            En mars 2010, elle abandonne MySQL pour Cassandra, une base de données NoSQL.
                        </p>
                        <p class="note fragment">
                            Cf <a href="https://web.archive.org/web/20120307033743/http://about.digg.com/node/564"><em>Saying Yes to NoSQL; Going Steady with Cassandra</em></a>.
                        </p>
                    </section>
                    <section>
                        <q>
                            Our primary motivation for moving away from MySQL is the increasing difficulty of building a <mark>high performance</mark>, <mark>write intensive</mark>, application on a <mark>data set that is growing quickly</mark>.
                        </q>
                        <p class="note fragment">
                            On retrouve l'argument du passage à l'échelle, avancé par les <em>Web 2.0 companies</em>.
                        </p>
                    </section>
                    <section>
                        <q>
                            This growth has forced us into horizontal and vertical partitioning strategies that have <mark>eliminated most of the value of a relational database</mark>, while still incurring all the overhead.
                        </q>
                        <p class="note fragment">
                            Le mouvement NoSQL n'a effectivement pas gardé grand chose d'SQL&hellip; d'où une confusion sur le nom.
                        </p>
                    </section>
                    <section>
                        <p>
                            Les modèles NoSQL dénormalisés et <em>schema-less</em> permettent chacun des <mark>optimisations</mark> algorithmiques <mark>spécifiques</mark> dans les systèmes de gestion (DBMS) associés.
                        </p>
                    </section>
                    <section>
                        <p>
                            Ils peuvent cependant être comparés selon les termes de l'<mark>algèbre relationnelle</mark>, d'un point de vue <mark>théorique</mark>.
                        </p>
                    </section>
                </section>
                <section>
                    <h4>Le modèle «&nbsp;paire clé-valeur&nbsp;»</h4>
                    <section>
                        <table class="plain">
                            <thead>
                                <tr>
                                    <!-- <th rowspan="2"></th> -->
                                    <th>
                                        <a href="http://aws.amazon.com/dynamodb/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-dynamodb.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://redis.io/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-redis.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://dbmx.net/tkrzw/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-tkrzw.png">
                                        </a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>DynamoDB</th>
                                    <th>Redis</th>
                                    <th>Tkrzw</th>
                                    <!-- Memcached -->
                                    <!-- Oracle BerkeleyDB: https://www.oracle.com/database/technologies/related/berkeleydb.html -->
                                </tr>
                            </thead>
                            <!-- <tbdoy>
                                <tr>
                                    <th>Propriétaire</th>
                                    <td>Amazon Web Services</td>
                                    <td>Redis Ltd.</td>
                                    <td>M. Hirabayashi <span style="font-size: 0.5em;">(Google)</span></td>
                                </tr>
                                <tr>
                                    <th>Licence</th>
                                    <td>-</td>
                                    <td>BSD</td>
                                    <td>Apache</td>
                                </tr>
                            </tbdoy> -->
                            <caption>Ex. de DBMS pour le modèle «&nbsp;paire clé-valeur&nbsp;»</caption>
                        </table>
                    </section>
                    <section>
                        <p>
                            Un DBMS «&nbsp;paire clé-valeur&nbsp;» ne gère qu'<mark>une seule relation</mark> <span class="var">KV</span>.
                        </p>
                    </section>
                    <section>
                        <p>
                            S<sub><span class="var">KV</span></sub> = {<span class="var">Key</span>, <span class="var">Value</span>}
                        </p>
                        <p class="fragment">
                            <span class="var">Key</span> → <span class="var">Value</span>
                        </p>
                    </section>
                    <section>
                        <p class="phi">
                            <span class="var">KV</span> = {<br>
                            &nbsp;&nbsp;(#001, (Bulbizarre, 0.7, 6.9, &hellip;)),<br>
                            &nbsp;&nbsp;(#004, (Salamèche, 0.6, 8.5, Feu)),<br>
                            &nbsp;&nbsp;(#007, (Carapuce, 0.5, 9.0, Eau)),<br>
                            &nbsp;&nbsp;(#025, (Pikachu, 0.4, 6.0, &hellip;)),<br>
                            &nbsp;&nbsp;(#052, (Miaouss, 0.4, 4.2))<br>
                            }
                        </p>
                        <!-- include versions? -->
                        <!-- key/value is necessarily unique? -->
                    </section>
                    <section>
                        <p class="phi">
                            t = (#007, (Carapuce, 0.5, 9.0, Eau))
                        </p>
                        <p class="fragment phi">
                            t(<span class="var">Key</span>) = #007<br>
                            t(<span class="var">Value</span>) = (Carapuce, &hellip;)
                        </p>
                    </section>
                    <section data-background-color="moccasin">
                        En quoi le schéma {<span class="var">Key</span>, <span class="var">Value</span>} est-il dénormalisé ?
                    </section>
                    <section>
                        <p>
                            L'attribut <span class="var">Value</span> est <mark>décomposable</mark>.
                            Le schéma n'est donc pas en 1NF.
                        </p>
                        <p class="note fragment">
                            Une base de données de paires clé-valeur ne peut donc donner aucune garantie sur la cohérence des données.
                        </p>
                    </section>
                    <section>
                        <p>Les seules opérations possibles sur la base de données sont l'écriture et la lecture de valeurs <mark>par clé</mark>.</p>
                    </section>
                    <section>
                        <p>
                            Opérations d'écriture :
                        </p>
                        <ul>
                            <li><span class="var">KV</span>' = <span class="var">KV</span> ⋃ {(<span class="param">key</span>, <span class="param">value</span>)}</li>
                            <li><span class="var">KV</span>' = <span class="var">KV</span> ∖ {(<span class="param">key</span>, <span class="param">value</span>)}</li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            Opération de lecture :
                        </p>
                        <p>
                            π<sub><span class="var">Value</span></sub>(σ<sub><span class="var">Key</span>=<span class="param">key</span></sub>(<span class="var">KV</span>))
                        </p>
                        <p class="fragment note">
                            Certains DBMS autorisent aussi des requêtes par intervalle :<br>
                            <span class="var">Key</span> &gt; <span style="color: gray;">lower_key</span> <b>AND</b>
                            <span class="var">Key</span> &lt; <span style="color: gray;">upper_key</span>
                        </p>
                    </section>
                    <section>
                        <p>
                            La relation <span class="var">KV</span> est souvent implémentée comme une <mark>table de hachage</mark>.
                        </p>
                        <p class="fragment">Elle peut facilement être partionnée <mark>horizontalement</mark> (par lignes).</p>
                    </section>
                    <section>
                        <p>Le modèle  «&nbsp;paire clé-valeur&nbsp;» permet une <mark>grande vitesse</mark> de lecture/écriture.</p>
                        <p class=" fragment note">
                            Redis peut par exemple effectuer ~500k lectures/écritures par seconde sur une machine standard (voir <a href="https://web.archive.org/web/20220404031716/https://redis.io/docs/reference/optimization/benchmarks/">benchmark</a>).
                        </p>
                    </section>
                    <section data-background-color="moccasin">
                        <p>
                            Proposez des exemples d'usages de bases de données clé-valeur.
                        </p>
                    </section>
                    <section>
                        <p>
                            L'exemple de <mark>DynamoDB</mark> est l'un des plus emblématiques.
                        </p>
                    </section>
                    <section>
                        <p>
                            Amazon a développé cette base de données pour pour gérer :
                        </p>
                        <ul>
                            <li class="fragment">son cataloque de livre</li>
                            <li class="fragment">des préférences d'utilisation</li>
                            <li class="fragment">les achats en cours (paniers)</li>
                        </ul>
                        <p class="fragment note">
                            ... d'après un article de <a href="https://doi.org/10.1145/1323293.1294281">DeCandia <em>et al.</em></a> paru en 2007.
                        </p>
                        <!-- https://s3.amazonaws.com/AllThingsDistributed/sosp/amazon-dynamo-sosp2007.pdf -->
                    </section>
                    <section>
                        <p class="phi">
                            S<sub><span class="var">Catalog</span></sub> = {<span class="var">ISBN</span>, <span class="var">Info</span>}
                        </p>
                        <p class="phi">
                            S<sub><span class="var">Users</span></sub> = {(<span class="var">LastName</span>, <span class="var">FirstName</span>), <span class="var">Prefs</span>}
                        </p>
                        <p class="phi">
                            S<sub><span class="var">Carts</span></sub> = {<span class="var">SessionID</span>, <span class="var">Items</span>}
                        </p>
                        <!-- utilisateur·trice déjà identifié·e -->
                    </section>
                </section>
                <section>
                    <h4>Le modèle «&nbsp;document&nbsp;»</h4>
                    <section>
                        <table class="plain">
                            <thead>
                                <tr>
                                    <th>
                                        <a href="http://mongodb.com/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-mongodb.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://couchdb.apache.org/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-couchdb.png">
                                        </a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>MongoDB</th>
                                    <th>CouchDB</th>
                                </tr>
                            </thead>
                            <caption>Ex. de DBMS pour le modèle «&nbsp;document&nbsp;»</caption>
                        </table>
                        <!-- CouchDB ne permet que de faire des requêtes par ID, pas par valeurs de champs -->
                    </section>
                    <section>
                        <p>
                            Le modèle «&nbsp;document&nbsp;» est une <mark>extension</mark> de celui de «&nbsp;paire clé-valeur&nbsp;».
                        </p>
                        <p class="fragment">
                            Un <mark>document</mark> est une <mark>valeur</mark> identifiée par une clé.
                        </p>
                    </section>
                    <section>
                        <p>
                            Dans une paire clé-valeur, la valeur est <mark>opaque</mark> (non-interprétée par le DBMS).
                        </p>
                        <p class="fragment">
                            Un document peut être requêté selon <mark>son contenu</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Un document est lui-même un ensemble de paires clé-valeur (<mark>champs</mark>).
                        </p>
                        <p class="fragment">
                            La <mark>valeur</mark> d'un champ elle-même peut être un <mark>document</mark> (récursivement).
                        </p>
                        <!-- <p class="fragment">
                            Les noms de champs dans un document sont <mark>uniques</mark>.
                        </p> -->
                        <!-- <p class="fragment">
                            Les valeurs des champs sont <mark>typées</mark>.
                        </p> -->
                    </section>
                    <section>
                        <p>
                            S<sub><span class="var">Inventory</span></sub> = {<span class="var">ID</span>, <span class="var">Doc</span>}
                        </p>
                        <p class="fragment">
                            <span class="var">ID</span> → <span class="var">Doc</span>
                        </p>
                    </section>
                    <section>
                        <p class="phi">
                            <span class="var">Inventory</span> = {<br>
                            &nbsp;&nbsp;(#001, doc<sub>1</sub>),<br>
                            &nbsp;&nbsp;(#004, doc<sub>4</sub>),<br>
                            &nbsp;&nbsp;(#007, doc<sub>7</sub>),<br>
                            &nbsp;&nbsp;(#025, doc<sub>25</sub>),<br>
                            &nbsp;&nbsp;(#052, doc<sub>52</sub>)<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p class="phi">
                            doc<sub>1</sub> = {<br>
                            &nbsp;&nbsp;(Nom, Bulbizarre),<br>
                            &nbsp;&nbsp;(Taille, 0.7),<br>
                            &nbsp;&nbsp;(Poids, 6.9),<br>
                            &nbsp;&nbsp;(Type, {Plante, Poison})<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            Les opérations d'écriture sur une base de documents sont les mêmes que sur des paires clé-valeur.
                        </p>
                        <ul class="fragment">
                            <li><span class="var">Inventory</span>' = <span class="var">Inventory</span> ⋃ {(<span class="param">id</span>, <span class="param">doc</span>)}</li>
                            <li><span class="var">Inventory</span>' = <span class="var">Inventory</span> ∖ {(<span class="param">id</span>, <span class="param">doc</span>)}</li>
                        </ul>
                    </section>
                    <section>
                        <p>
                            Les opérations de lecture sont l'accès <mark>par identifiant</mark> et la recherche <mark>par valeur de champ</mark>.
                        </p>
                        <ul class="fragment">
                            <li>π<sub><span class="var">Doc</span></sub>(σ<sub><span class="var">ID</span>=<span class="param">id</span></sub>(<span class="var">Inventory</span>))</li>
                            <li>σ<sub><span class="param">Q</span></sub>(π<sub><span class="var">Doc</span></sub>(<span class="var">Inventory</span>))</li>
                        </ul>
                        <!-- recursive query: select on field key -->
                    </section>
                    <section>
                        <p>
                            En pratique, une base de documents est implémentée comme une base de données clé-valeur où :
                        </p>
                        <ul>
                            <li class="fragment">la <mark>valeur</mark> est un <mark>document</mark>, stocké dans format binaire dérivé de <mark>JSON</mark></li>
                            <li class="fragment">des <mark>annuaires inversés</mark> permettent d'accéder aux identifiants à partir des valeurs de champs</li>
                        </ul>
                    </section>
                    <section>
                        <p class="json">
                            bulbizarre#001 = {<br>
                            &nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">1</span>,<br>
                            &nbsp;&nbsp;<span class="string">"name"</span>: <span class="string">"Bulbizarre"</span>,<br>
                            &nbsp;&nbsp;<span class="string">"height"</span>: <span class="nb">0.7</span>,<br>
                            &nbsp;&nbsp;<span class="string">"weight"</span>: <span class="nb">6.9</span>,<br>
                            &nbsp;&nbsp;<span class="string">"type"</span>: [ <span class="string">"plant"</span>, <span class="string">"poison"</span> ]<br>
                            }
                        </p>
                        <p class="note fragment">
                            ⚠ Le format utilisé ici n'est pas une notation mathématique, c'est le format <span class="highlight">JSON</span>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Les documents sont des données <mark>semi-structurées</mark>.
                        </p>
                        <p class="fragment">
                            La <mark>structure d'un document</mark> peut <mark>évoluer</mark> sans changer l'ensemble du contenu de la base.
                        </p>
                    </section>
                    <section data-auto-animate>
                        <p class="json" data-id="obj">
                            bulbizarre#001 = {<br>
                            &nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">1</span>,<br>
                            &nbsp;&nbsp;<span class="string">"name"</span>: <span class="string">"Bulbizarre"</span>,<br>
                            &nbsp;&nbsp;<span class="string">"height"</span>: <span class="nb">0.7</span>,<br>
                            &nbsp;&nbsp;<span class="string">"weight"</span>: <span class="nb">6.9</span>,<br>
                            &nbsp;&nbsp;<span class="string">"type"</span>: [ <span class="string">"plant"</span>, <span class="string">"poison"</span> ]<br>
                            }
                        </p>
                    </section>
                    <section data-auto-animate>
                        <p class="json" data-id="obj">
                            bulbizarre#001 = {<br>
                            &nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">1</span>,<br>
                            &nbsp;&nbsp;<span class="string">"name"</span>: <span class="string">"Bulbizarre"</span>,<br>
                            &nbsp;&nbsp;<span class="string">"height"</span>: <span class="nb">0.7</span>,<br>
                            &nbsp;&nbsp;<span class="string">"weight"</span>: <span class="nb">6.9</span>,<br>
                            &nbsp;&nbsp;<span class="string">"type"</span>: [ <span class="string">"plant"</span>, <span class="string">"poison"</span> ],<br>
                            &nbsp;&nbsp;<span style="font-weight: bold;"><span class="string">"chromatic"</span>: true</span><br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            Le modèle «&nbsp;document&nbsp;» est un <mark>compromis</mark> entre le modèle relationnel (granularité des requêtes) et le modèle «&nbsp;paire clé-valeur&nbsp;» (rapidité de lecture/écriture).
                        </p>
                        <p class="fragment">
                            Il est conçu pour un accès à distance des documents, via une <mark>interface Web</mark>.
                        </p>
                    </section>
                    <section data-background-color="moccasin">
                        <p>
                            Donnez des exemples de documents difficiles à stocker dans une base de données relationnelle.
                        </p>
                    </section>
                    <section>
                        <p>
                            Exemples de documents&nbsp;:
                        </p>
                        <ul>
                            <li class="fragment">
                                contenu web multimédia<br>
                                <span style="color: lightgray; font-size: 0.65em;">tweets avec aperçu, vidéos, infographies, etc.</span>
                            </li>
                            <!-- https://www.mongodb.com/use-cases/content-management -->
                            <li class="fragment">
                                documents d'entreprise<br>
                                <span style="color: lightgray; font-size: 0.65em;">profils clients, factures, fiches produits, etc.</span>
                            </li>
                            <!-- https://www.mongodb.com/use-cases/single-view -->
                            <li class="fragment">historiques d'objets connectés</li>
                            <!-- https://www.mongodb.com/use-cases/internet-of-things -->
                            <!-- https://www.mongodb.com/blog/post/video-toyota-industry-40-creating-smart-factory-moving-from-monolithic-code-base-microservices-mongodb-atlas-microsoft-azure -->
                        </ul>
                        <p class="fragment note">
                            ... d'après <a href="https://www.mongodb.com/use-cases/"><em>MongoDB use cases</em></a> (<em>Content Management</em>, <em>Single View</em> et <em>Internet of Things</em>).
                        </p>
                    </section>
                </section>
                <section>
                    <h4>Le modèle «&nbsp;à colonne extensible&nbsp;»</h4>
                    <section>
                        <table class="plain">
                            <thead>
                                <tr>
                                    <th>
                                        <a href="https://cloud.google.com/bigtable/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-google-cloud.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://hbase.apache.org/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-hbase.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="http://cassandra.apache.org/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-cassandra.png">
                                        </a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Bigtable</th>
                                    <th>HBase</th>
                                    <th>Cassandra</th>
                                </tr>
                            </thead>
                            <caption>Ex. de DBMS pour le modèle «&nbsp;à colonne extensible&nbsp;»</caption>
                        </table>
                    </section>
                    <section>
                        <p>
                            Le modèle «&nbsp;document&nbsp;» permet d'accéder efficacement à des données structurées <mark>en arbre</mark>.
                        </p>
                    </section>
                    <section>
                        <p class="json">
                            bulbizarre#001 = {<br>
                            &nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">1</span>,
                                        <span class="string">"name"</span>: <span class="string">"Bulbizarre"</span>,<br>
                            &nbsp;&nbsp;<span class="string">"evolution"</span>: {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">2</span>,
                                                    <span class="string">"name"</span>: <span class="string">Herbizarre</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"evolution"</span>: {<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"rank"</span>: <span class="nb">3</span>,
                                                                <span class="string">"name"</span>: <span class="string">Florizarre</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"evolution"</span>: null<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
                            &nbsp;&nbsp;}<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            Le modèle «&nbsp;à colonne extensible&nbsp;» conserve la structure de <mark>table</mark>, avec accès par <mark>ligne</mark> et par <mark>colonne</mark>.
                        </p>
                        <p class="fragment">
                            À la différence du modèle relationnel, une ligne peut avoir un <mark>nombre variable de colonnes</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            S<sub><span class="var">Table</span></sub> = {<span class="var">RowKey</span>, <span class="var">Family<sub>1</sub></span>, &hellip;, <span class="var">Family<sub>n</sub></span>}
                        </p>
                        <p class="fragment">
                            <span class="var">RowKey</span> → <span class="var">Family<sub>i</sub></span> <span style="color: lightgray;">(pour i ∈ [1, n])</span>
                        </p>
                    </section>
                    <section>
                        <p>
                            Dans l'exemple du Pokédex, on peut avoir par exemple <mark>deux familles</mark> de colonnes :
                        </p>
                        <ul>
                            <li class="fragment">les valeurs qualitatives (<span class="var">Quali</span>)</li>
                            <li class="fragment">les valeurs quantitatives (<span class="var">Quanti</span>)</li>
                        </ul>
                    </section>
                    <section>
                        <p class="phi">
                            <span class="var">Table</span> = {<br>
                            &nbsp;&nbsp;(#001, quali<sub>1</sub>, quanti<sub>1</sub>),<br>
                            &nbsp;&nbsp;(#004, quali<sub>4</sub>, quanti<sub>4</sub>),<br>
                            &nbsp;&nbsp;(#007, quali<sub>7</sub>, quanti<sub>7</sub>),<br>
                            &nbsp;&nbsp;(#025, quali<sub>25</sub>, quanti<sub>25</sub>),<br>
                            &nbsp;&nbsp;(#052, quali<sub>52</sub>, quanti<sub>52</sub>)<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p class="phi">
                            quali<sub>1</sub> = {<br>
                            &nbsp;&nbsp;(Nom, Bulbizarre),<br>
                            &nbsp;&nbsp;(Type, {Plante, Poison})<br>
                            }
                        </p>
                        <p class="fragment phi">
                            quanti<sub>1</sub> = {<br>
                            &nbsp;&nbsp;(Taille, 0.7),<br>
                            &nbsp;&nbsp;(Poids, 6.9)<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            L'écriture se fait soit par ligne entière, soit par colonne.
                        </p>
                        <!-- sur Cassandra : écriture par ligne seulement -->
                        <!-- sur Bigtable/HBase : une écriture se fait par ligne/colonne ; écritures sur une même ligne isolées dans une transaction -->
                        <ul class="fragment">
                            <li>
                                <span class="var">Table</span>' = <span class="var">Table</span> ⋃ {(<span class="param">key</span>, <span class="param">row</span>)}
                            </li>
                            <li>
                                <span class="var">Table</span>' = <span class="var">Table</span><br>
                                &nbsp;&nbsp;∖ {(<span class="param">key</span>, &hellip;, <span class="param">cf<sub>i</sub></span>, &hellip;)}<br>
                                &nbsp;&nbsp;⋃ {(<span class="param">key</span>, &hellip;, <span class="param">cf<sub>i</sub></span> ⋃ (<span class="param">col</span>, <span class="param">cell</span>), &hellip;)}
                            </li>
                        </ul>
                        <p class="note fragment">
                            Idem pour la suppression&hellip;
                        </p>
                    </section>
                    <section>
                        <p>
                            Pour la lecture, on peut voir une table comme une base de données clé-valeur à deux niveaux :
                        </p>
                        <ol>
                            <li class="fragment">
                                accès par clé <mark>aux lignes</mark>
                            </li>
                            <li class="fragment">
                                accès par clé et par identifiant de colonne <mark>aux cellules</mark>
                            </li>
                        </ol>
                    </section>
                    <section>
                        <p>
                            C'est-à-dire, en algèbre relationnelle&nbsp;:
                        </p>
                        <ol>
                            <li class="fragment">
                                π<sub>S<sub><span class="var">Table</span></sub> ∖ <span class="var">RowKey</span></sub>(σ<sub><span class="var">RowKey</span>=<span class="param">key</span></sub>(<span class="var">Table</span>))
                            </li>
                            <li class="fragment">
                                π<sub><span class="var">Value</span></sub>(σ<sub><span class="var">Key</span>=<span class="param">col</span></sub>(Ans))<br>
                                où Ans = π<sub><span class="var">Family<sub>i</sub></span></sub>(σ<sub><span class="var">RowKey</span>=<span class="param">key</span></sub>(<span class="var">Table</span>))
                            </li>
                        </ol>
                    </section>
                    <section>
                        <p>
                            L'accès à plusieurs colonnes sur une même ligne est limité aux <mark>familles de colonnes</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Les deux exemples emblématiques du modèle «&nbsp;à colonnes extensibles&nbsp;» sont:
                        </p>
                        <ul>
                            <li class="fragment"><em>(Google)</em> la gestion des hyperliens de pages HTML</li>
                            <!-- column families: content, anchors -->
                            <li class="fragment"><em>(Facebook)</em> la recherche de messages dans un historique de conversations</li>
                            <!-- column families: term (for search), interactions -->
                        </ul>
                    </section>
                    <section data-background-color="moccasin">
                        <p>
                            Proposez un schéma à colonnes extensibles pour les deux exemples précédents.
                        </p>
                    </section>
                    <section>
                        <p>Schémas choisis par Google et Facebook&nbsp;:</p>
                        <ul>
                            <li class="fragment"><em>(Google)</em> deux familles de colonnes : contenu textuel, <em>anchor</em></li>
                            <li class="fragment"><em>(Facebook)</em> deux familles de colonnes : terme, destinataires</li>
                            <!-- https://www.cs.cornell.edu/projects/ladis2009/papers/lakshman-ladis2009.pdf -->
                        </ul>
                        <p class="fragment note">
                            ... d'après des articles de <a href="https://doi.org/10.1145/1365815.1365816">Chang <em>et al.</em></a> (2008) et <a href="https://doi.org/10.1145/1773912.1773922">Lakshman &amp; Malik</a> (2009).
                        </p>
                    </section>
                    <!-- TODO SQL pour requêter avec le modèle wide column ? -->
                </section>
                <section>
                    <h4>Le modèle «&nbsp;en graphe&nbsp;»</h4>
                    <section>
                        <table class="plain">
                            <thead>
                                <tr>
                                    <th>
                                        <a href="https://neo4j.com/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-neo4j.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="http://tinkerpop.apache.org/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-tinkerpop.png">
                                        </a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Neo4j</th>
                                    <th>TinkerPop<sup><a href="#/hybrid-dbms/0">*</a></sup></th>
                                </tr>
                            </thead>
                            <caption>Ex. de DBMS pour le modèle «&nbsp;en graphe&nbsp;»</caption>
                        </table>
                    </section>
                    <section>
                        <p>
                            SQL est un langage <mark>expressif</mark> et pour lequel la recherche de solution est <mark>polynomiale</mark>.
                        </p>
                        <p class="fragment">
                            Mais il ne <mark>peut pas exprimer</mark> toutes les requêtes possibles sur des données relationnelles.
                        </p>
                    </section>
                    <section>
                        <p>
                            Par exemple, SQL ne peut pas exprimer une <mark>recherche de chemin</mark> entre un point A et un point B.
                        </p>
                        <p class="fragment note">
                            L'exemple est donné par Serge Abiteboul dans sa <a href="https://www.college-de-france.fr/site/serge-abiteboul/inaugural-lecture-2012-03-08-18h00.htm">leçon inaugurale</a> de 2011 au Collège de France (21').
                        </p>
                    </section>
                    <section>
                        <p>
                            Les bases de données «&nbsp;en graphe&nbsp;» cherchent à la fois&nbsp;:
                        </p>
                        <ul>
                            <li class="fragment">à proposer de <mark>nouveaux langages</mark> de requête pour le parcours de graphes</li>
                            <li class="fragment">à définir des <mark>structures de données optimisées</mark> pour ces langages</li>
                        </ul>
                    </section>
                    <section>
                        <p class="sql">
                            CREATE TABLE <span class="var">Node</span>(<br>
                            &nbsp;&nbsp;<span class="var">Id</span> BIGINT,<br>
                            &nbsp;&nbsp;<span class="var">Label</span> VARCHAR(n),<br>
                            &nbsp;&nbsp;PRIMARY KEY <span class="var">Id</span><br>
                            ) ;<br>
                            <br>
                            CREATE TABLE <span class="var">Edge</span>(<br>
                            &nbsp;&nbsp;<span class="comment">-- même schéma</span><br>
                            ) ;
                        </p>
                    </section>
                    <section>
                        <p class="sql" style="width: 120%;">
                            CREATE TABLE <span class="var">NodeProperty</span>(<br>
                            &nbsp;&nbsp;<span class="var">Id</span> BIGINT,<br>
                            &nbsp;&nbsp;<span class="var">Name</span> VARCHAR(<span class="param">n</span>),<br>
                            &nbsp;&nbsp;<span class="var">Value</span> VARCHAR(<span class="param">m</span>),<br>
                            &nbsp;&nbsp;PRIMARY KEY (<span class="var">Id</span>, <span class="var">Name</span>)<br>
                            ) ;<br>
                            <br>
                            CREATE TABLE <span class="var">EdgeProperty</span>(<br>
                            &nbsp;&nbsp;<span class="comment">-- même schéma</span><br>
                            ) ;
                        </p>
                    </section>
                    <section>
                        <p class="sql" style="width: 120%;">
                            CREATE TABLE <span class="var">Relationship</span>(<br>
                            &nbsp;&nbsp;<span class="var">SourceId</span> BIGINT,<br>
                            &nbsp;&nbsp;<span class="var">EdgeId</span> BIGINT,<br>
                            &nbsp;&nbsp;<span class="var">TargetId</span> BIGINT,<br>
                            &nbsp;&nbsp;PRIMARY KEY (<span class="var">SourceId</span>, <span class="var">EdgeId</span>, <span class="var">TargetId</span>)<br>
                            ) ;
                        </p>
                    </section>
                    <section>
                        <p>L'écriture peut se faire par nœud ou par arête.</p>
                    </section>
                    <section>
                        <p>Deux familles distinctes de langages de requête existent&nbsp;: langages <mark>déclaratifs</mark> et langages <mark>prodéduraux</mark>.</p>
                        <table class="fragment">
                            <thead>
                                <tr>
                                    <th>Langage</th>
                                    <th>DBMS</th>
                                    <th>Famille(s)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><a href="https://neo4j.com/docs/cypher-refcard/current/">Cypher</a></td>
                                    <td>Neo4j</td>
                                    <td>déclaratif</td>
                                </tr>
                                <tr>
                                    <td><a href="http://tinkerpop.apache.org/gremlin.html">Gremlin</a></td>
                                    <td>TinkerPop</td>
                                    <td>procédural(, déclaratif)</td>
                                </tr>
                            </tbody>
                            <caption>Langages principaux de requêtes sur des données en graphe</caption>
                        </table>
                        <p class="fragment note">
                            Avant qu'SQL ne domine progressivement, il existait la même opposition entre SQL et des langages procéduraux.
                        </p>
                    </section>
                    <section>
                        <p>
                            Cypher permet de spécifier les <mark>chemins</mark> d'un graphe comme des <mark>expressions régulières</mark>.
                        </p>
                    </section>
                    <section>
                        <p class="cypher">
                            MATCH<br>
                            (<span class="param">source</span>)-[<span class="param">rel</span>]->(<span class="param">cible</span>) ;
                        </p>
                    </section>
                    <section>
                        <p>(Q<sub>2</sub>) Quels sont les champions Pokémon de la région de Kanto ?</p>
                        <p class="fragment cypher">
                            MATCH<br>
                            (gymLeader:<span class="var">GymLeader</span>)<br>
                            &nbsp;&nbsp;-[:<span class="var">leads</span>]->()<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;-[:<span class="var">locatedIn</span>*]->({id: <span class="string">"kanto"</span>}) ;
                        </p>
                        <!-- TODO exemple Pokémon ? Localisation des Pokémon sur la carte pour un calcul de distance ? -->
                    </section>
                    <section>
                        <p>
                            Gremlin (dans sa forme procédurale) permet de spécifier un chemin comme une <mark>série d'instructions</mark> de navigation d'un nœud à l'autre.
                        </p>
                    </section>
                    <section>
                        <p>(Q<sub>2</sub>)</p>
                        <p class=" fragment gremlin">
                            g.V().has(<span class="string">"type"</span>, "GymLeader")<br>
                            &nbsp;&nbsp;.out(<span class="string">"leads"</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.repeat(__.out(<span class="string">"locatedIn"</span>))<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.has(<span class="string">"id"</span>, <span class="string">"kanto"</span>)<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;.emit()
                        </p>
                    </section>
                    <section>
                        <p>
                            Exemples de graphes :
                        </p>
                        <ul>
                            <li class="fragment">réseau social</li>
                            <li class="fragment">données géo-spatiales</li>
                            <li class="fragment">graphes de connaissance</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <h4>Le modèle «&nbsp;RDF&nbsp;»</h4>
                    <section>
                        <table class="plain">
                            <thead>
                                <tr>
                                    <th>
                                        <a href="https://jena.apache.org/documentation/fuseki2/index.html/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-jena.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://graphdb.ontotext.com/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-graphdb.png">
                                        </a>
                                    </th>
                                    <th>
                                        <a href="https://www.stardog.com/">
                                            <img class="thumbnail" src="../misc/nosql-intro/logo-thumbnail-stardog.png">
                                        </a>
                                    </th>
                                </tr>
                                <tr>
                                    <th>Fuseki</th>
                                    <th>GraphDB</th>
                                    <th>Stardog</th>
                                </tr>
                            </thead>
                            <caption>Ex. de DBMS pour le modèle «&nbsp;RDF&nbsp;»</caption>
                        </table>
                    </section>
                    <section>
                        <p>
                            Les arêtes d'un graphe sont parfois interdépendantes et/ou implicites.
                        </p>
                        <p class="fragment">
                            Par exemple, la relation géo-spatiale <span style="font-weight: bold; font-style: italic;">locatedIn</span> est <mark>transitive</mark>.
                        </p>
                        <p class="fragment">
                            C'est aussi l'<mark>inverse</mark> de la relation <span style="font-weight: bold; font-style: italic;">containsPlace</span>.
                        </p>
                    </section>
                    <section>
                        <p>
                            Le modèle «&nbsp;RDF&nbsp;» est conçu pour intégrer une couche <mark>sémantique</mark> aux bases de données en graphe.
                        </p>
                        <p class="fragment">
                            RDF, acronyme pour <em>Resource Description Framework</em> permet surtout de décrire la sémantique de <mark>ressources web</mark>.
                        </p>
                    </section>
                    <section>
                        <p class="sql" style="width: 120%;">
                            CREATE TABLE <span class="var">Triple</span>(<br>
                            &nbsp;&nbsp;<span class="var">Subject</span> VARCHAR(<span class="param">n</span>),<br>
                            &nbsp;&nbsp;<span class="var">Predicate</span> VARCHAR(<span class="param">n</span>),<br>
                            &nbsp;&nbsp;<span class="var">Object</span> VARCHAR(<span class="param">n</span>),<br>
                            &nbsp;&nbsp;PRIMARY KEY (<span class="var">Subject</span>, <span class="var">Predicate</span>, <span class="var">Object</span>)<br>
                            ) ;
                        </p>
                        <!-- TODO prendre en compte les node types et datatype/lang -->
                    </section>
                    <section>
                        <p class="sql">
                            INSERT INTO <span class="var">Triple</span> VALUES (<span class="param">s</span>, <span class="param">p</span>, <span class="param">o</span>) ;
                        </p>
                    </section>
                    <section>
                        <p>
                            Les requêtes sur une base de données RDF s'expriment avec le langage <mark>SPARQL</mark>.
                        </p>
                        <p class="fragment">
                            SPARQL est un <mark>langage déclaratif</mark>, plus <mark>générique</mark> que SQL.
                        </p>
                        <p class="fragment note">
                            Toute requête SQL peut s'exprimer en SPARQL mais SPARQL supporte aussi des expressions régulières. 
                        </p>
                    </section>
                    <section>
                        <p>(Q<sub>2</sub>)</p>
                        <p class="fragment sparql">
                            SELECT ?gymLeader<span class="var"></span> WHERE {<br>
                            &nbsp;&nbsp;?gymLeader <span class="string">a</span> <span class="var">:Trainer</span> .<br>
                            &nbsp;&nbsp;?gymLeader <span class="var">:leads</span> ?gym .<br>
                            &nbsp;&nbsp;?gym <span class="var">:locatedIn</span> &lt;kanto&gt; .<br>
                            }
                        </p>
                    </section>
                    <section>
                        <p>
                            Exemples de jeux de données RDF :
                        </p>
                        <ul>
                            <li class="fragment">le <a href="https://www.lod-cloud.net/"><em>Linked Open Data Cloud</em></a></li>
                            <li class="fragment">les bibliothèques numériques</li>
                            <li class="fragment">les graphes de connaissances</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <h4>Extensions des modèles NoSQL</h4>
                    <section>
                        <p>
                            Les modèles de données NoSQL sont performants mais <mark>spécialisés</mark>.
                        </p>
                        <p class="fragment">
                            Certains DBMS recherchent la <mark>généricité</mark> du modèle relationnel en adoptant des <mark>modèles hybrides</mark>.
                        </p>
                    </section>
                    <section id="hybrid-dbms">
                        <table style="font-size: 0.5em;">
                            <thead>
                                <tr>
                                    <th rowspan="2">Modèle de données</th>
                                    <th colspan="5">DBMS</th>
                                </tr>
                                <tr>
                                    <td><a href="https://orientdb.org/">OrientDB</a></td>
                                    <td><a href="https://tinkerpop.apache.org/">TinkerPop</a></td>
                                    <td><a href="https://allegrograph.com/">AllegroGraph</a></td>
                                    <td><a href="https://aws.amazon.com/fr/neptune/">Neptune</a></td>
                                    <td><a href="https://virtuoso.openlinksw.com/">Virtuoso</a></td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>paire clé-valeur</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>document</td>
                                    <td>✓</td>
                                    <td>(✓)</td>
                                    <td>✓</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>à colonne ext.</td>
                                    <td></td>
                                    <td>✓</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>en graphe</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                    <td></td>
                                    <td>✓</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>RDF</td>
                                    <td></td>
                                    <td>✓</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                    <td>✓</td>
                                </tr>
                                <tr>
                                    <td>relationnel</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td>✓</td>
                                </tr>
                            </tbody>
                            <caption style="font-size: 1em;">Ex. de DBMS avec modèle de données hybrides</caption>
                        </table>
                        <p class="note fragment">
                            TinkerPop n'est pas un pur DBMS. C'est un <em>midldleware</em> faisant le lien entre un langage de requête (Gremlin) et un DBMS (voir <a href="https://tinkerpop.apache.org/#graph-systems">liste</a>).
                        </p>
                    </section>
                    <section>
                        <p>
                            Une partie des DBMS incluent aussi un <mark>modèle temporel</mark>.
                        </p>
                        <p class="fragment">
                            Une unité de données (paire clé-valeur, document, cellule) peut être associée à un <mark>numéro de version</mark>.
                        </p>
                    </section>
                </section>
                <section>
                    <h4>Résumé</h4>
                    <section data-background-color="moccasin">
                        <p>
                            Définissez NoSQL en 5 points.
                        </p>
                    </section>
                    <section>
                        <ol style="font-size: 0.75em;">
                            <li class="fragment">une base de données NoSQL utilise souvent un schéma dénormalisé.</li>
                            <li class="fragment">la définition stricte de NoSQL s'appuie sur 3 points: parallélisme, faible coût matériel, accès distant.</li>
                            <li class="fragment">les 3 principaux modèles NoSQL sont: clé-valeur, document, colonne extensible.</li>
                            <li class="fragment">la définition s'étend aussi aux bases de données en graphe et RDF.</li>
                            <li class="fragment">les modèles NoSQL peuvent se combiner.</li>
                        </ol>
                    </section>
                </section>
                <section>
                    <h4>Pour aller plus loin...</h4>
                    <section>
                        <ul style="font-size: 0.5em;">
                            <li>Eric Lai (2009), <a href="https://www.computerworld.com/article/2526317/no-to-sql--anti-database-movement-gains-steam.html">"No to SQL? Anti-database movement gains steam</a>," Computerworld, IDG Commmunications.</li>
                            <li>Ben Scofield (2010), <a href="https://www.slideshare.net/bscofield/nosql-codemash-2010/">"NoSQL: Death to Relational Databases(?)</a>," <em>presenté à</em> CodeMash 2010.</li>
                            <li>Christof Strauch (2011), <a href="https://seafile.emse.fr/f/0e5bd840dbf14faba412/">NoSQL Databases</a>, Hochschule der Medien Stuttgart.</li>
                            <li>Seth Gilbert and Nancy Lynch (2002), <a href="https://dl.acm.org/doi/abs/10.1145/564585.564601">"Brewer's conjecture and the feasibility of consistent, available, partition-tolerant web services</a>," ACM SIGACT News.</li>
                            
                        </ul>
                    </section>
                </section>
                <section>
                    <h4>Pour aller <em>encore</em> plus loin...</h4>
                    <section>
                        <ul style="font-size: 0.5em;">
                            <li>Serge Abiteboul (2011), <a href="https://www.college-de-france.fr/site/serge-abiteboul/inaugural-lecture-2012-03-08-18h00.htm">Sciences des données&nbsp;: de la Logique du premier ordre à la Toile</a></li>
                            <!-- contextualise l'évolution d'SQL pour le web... et l'émergence de besoins fonctionnels pour NoSQL -->
                            <li>John F. Sowa (2007), <a href="https://ieeexplore.ieee.org/document/4136864">"Fads and Fallacies about Logic</a>," IEEE Intelligent Systems.</li>
                            <!-- discute SQL comme langage... universel. NoSQL intéressant théoriquement ? -->
                        </ul>
                    </section>
                </section>
            </div>
        </div>

		<script src="../js/slides.js"></script>
		<script src="../js/slides-code.js"></script>
		<script>
			Reveal.initialize({
				hash: true,
				plugins: [ RevealHighlight ]
			});
		</script>
    </body>
</html>