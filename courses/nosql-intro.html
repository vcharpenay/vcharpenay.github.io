<!DOCTYPE html>
<html>
    <head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Introduction à NoSQL</title>

		<link rel="stylesheet" href="../css/slides-reset.css">
		<link rel="stylesheet" href="../css/slides.css">
		<link rel="stylesheet" href="../css/slides-theme.css" id="theme">
		<link rel="stylesheet" href="../css/slides-code.css" id="highlight-theme">

		<style>
			.reveal .slides section section {
				margin-top: 1.5em; /* margin for upper section title */
			}

			.reveal .slides .note {
				padding: 0.5em;
				font-size: 0.5em;
				color: peru;
				background-color: moccasin;
			}

			.reveal .slides .note .highlight {
				color: brown;
			}
			
			.reveal .slides table {
				font-size: 0.65em;
			}
			
			.reveal .slides table.t {
				font-size: 0.75em;
			}
			
			.reveal .slides table.t th {
				background-color: moccasin;
			}
			
			.reveal .slides table.t td {
				background-color: linen;
			}

            .reveal .slides .var {
                color: darkmagenta;
                font-weight: bold;
            }

            .reveal .slides .comment {
                color: lightblue;
            }

			.reveal .slides figcaption {
				color: gray;
				font-size: 0.5em;
			}

			.reveal .slides figure img {
				max-height: 8em; /* FIXME should be a percent of total height */
			}

            .reveal .slides mark {
                background-color: moccasin;
            }
		</style>
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section>
                    <h1>Introduction à <span style="text-shadow: lightgrey 5px 5px;">No</span>SQL</h1>
                    <p><a href="https://www.vcharpenay.link/">Victor Charpenay</a></p>
                </section>
                <section data-background-image="../misc/nosql-intro/dr-no.png" data-background-opacity="0.25">
                    <!-- background source: https://www.youtube.com/watch?v=-bpvvOBV-q0 -->
                    <p>Que veut dire NoSQL ?</p>
                    <ol>
                        <li class="fragment">No structure QL</li>
                        <li class="fragment">Not SQL</li>
                        <li class="fragment">Not only SQL</li>
                        <li class="fragment">New SQL<span style="font-size: 0.5em;"> (en danois)</span></li>
                    </ol>
                    <!-- QCM : no structure QL, not SQL, not only SQL, new SQL (en néerlandais) -->
                </section>
                <section>
                    <h4>SQL (Rappel)</h4>
                    <section>
                        <p class="fragment">SQL signifie<br><mark>Structured Query Language</mark></p>
                        <p class="fragment">SQL est un langage <mark>déclaratif</mark> de manipulation de données <mark>relationnelles</mark>.</p>
                    </section>
                    <section>
                        <p style="text-align: left;">
                            CREATE TABLE <span style="color: lightgrey;">table</span>(<span style="color: lightgrey;">attribut(s)</span>) ;<br><br>
                            INSERT INTO <span style="color: lightgrey;">table</span> VALUES <span style="color: lightgrey;">tuple</span> ;
                        </p>
                    </section>
                    <section>
                        <table class="t" style="float: left;">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Nom</th>
                                    <th>Taille</th>
                                    <th>Poids</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.9kg</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Salamèche</td>
                                    <td>0.6m</td>
                                    <td>8.5kg</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Carapuce</td>
                                    <td>0.5m</td>
                                    <td>9.0kg</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Pikachu</td>
                                    <td>0.4m</td>
                                    <td>6.0kg</td>
                                </tr>
                                <tr>
                                    <td>#052</td>
                                    <td>Miaouss</td>
                                    <td>0.4m</td>
                                    <td>4.2kg</td>
                                </tr>
                            </tbody>
                        </table>

                        <table class="t">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Plante</td>
                                </tr>
                                <tr>
                                    <td>#001</td>
                                    <td>Poison</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Feu</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Eau</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Électrik</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section>
                        <p style="text-align: left;">
                            SELECT <span style="color: lightgrey;">attribut(s)</span><br>
                            FROM <span style="color: lightgrey;">table(s)</span><br>
                            WHERE <span style="color: lightgrey;">condition(s)</span> ;
                        </p>
                    </section>
                    <section>
                        <p>(Q<sub>1</sub>) Quel est le nom des Pokémon de type feu ?</p>
                        <p class="fragment" style="text-align: left;">
                            SELECT <span class="var">Nom</span><br>
                            FROM <span class="var">Pokémon</span> AS <span class="var">P</span>,<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="var">Pokémon Type</span> AS <span class="var">PT</span><br>
                            WHERE <span class="var">P</span>.<span class="var">Rang</span> = <span class="var">PT</span>.<span class="var">Rang</span> AND<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="var">Type</span> = Feu ;
                        </p>
                    </section>
                    <section>
                        <p>Un schéma de base de données peut être soumis à des <mark>dépendance fonctionnelle</mark>.</p>
                        <p class="fragment">Une <mark>clé primaire</mark> est un atribut duquel dépend fonctionnellement tous les attributs d'une table.</p>
                    </section>
                    <section>
                        <p>Le rang d'un Pokémon détermine son nom, sa taille et son poids.</p>
                        <p class="fragment"><span class="var">Rang</span> → (<span class="var">Nom</span>, <span class="var">Taille</span>, <span class="var">Poids</span>)</p>
                    </section>
                    <section>
                        <p>Un schéma <mark>normalisé</mark> garantit l'absence d'incohérences dans les données.</p>
                    </section>
                    <section>
                        <table class="t">
                            <thead>
                                <tr>
                                    <th>Rang</th>
                                    <th>Nom</th>
                                    <th>Taille</th>
                                    <th>Poids</th>
                                    <th>Type</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.9kg</td>
                                    <td>Plante</td>
                                </tr>
                                <tr>
                                    <td>#001</td>
                                    <td>Bulbizarre</td>
                                    <td>0.7m</td>
                                    <td>6.8kg</td>
                                    <td>Poison</td>
                                </tr>
                                <tr>
                                    <td>#004</td>
                                    <td>Salamèche</td>
                                    <td>0.6m</td>
                                    <td>8.5kg</td>
                                    <td>Feu</td>
                                </tr>
                                <tr>
                                    <td>#007</td>
                                    <td>Carapuce</td>
                                    <td>0.5m</td>
                                    <td>9.0kg</td>
                                    <td>Eau</td>
                                </tr>
                                <tr>
                                    <td>#025</td>
                                    <td>Pikachu</td>
                                    <td>0.4m</td>
                                    <td>6.0kg</td>
                                    <td>Électrik</td>
                                </tr>
                                <tr>
                                    <td>#052</td>
                                    <td>Miaouss</td>
                                    <td>0.4m</td>
                                    <td>4.2kg</td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section>
                        <p>Avec un schéma <mark>dénormalisé</mark>, la table ci-dessus ne respecte pas la dépendance fonctionnelle</p>
                        <p><span class="var">Rang</span> → <span class="var">Poids</span></p>
                    </section>
                    <section>
                        <p>Le fondement théorique d'SQL est l'<mark>algèbre relationnelle</mark>.</p>
                        <p class="fragment">table  ≡ relation</p>
                    </section>
                    <section>
                        <p>Les (principaux) opérateurs algébriques autorisés sur des relations sont:</p>
                        <ul>
                            <li class="fragment">sélection (σ)</li>
                            <li class="fragment">projection (π)</li>
                            <li class="fragment">jointure (⋈)</li>
                        </ul>
                    </section>
                    <section>
                        <p>Une requête SQL correspond à une opération algébrique sur une ou plusieurs relations.</p>
                        <p class="fragment">
                            Q<sub>1</sub> ≡ π<sub><span class="var">Nom</span></sub> ( σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">P</span> ⋈ <span class="var">PT</span> ) )
                        </p>
                    </section>
                    <section>
                        <p>Une requête peut être optimisée grâce aux identités algébriques des opérateurs.</p>
                        <p class="fragment">
                            π<sub><span class="var">Nom</span></sub> ( σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">P</span> ⋈ <span class="var">PT</span> ) )
                            <br>↓<br>
                            π<sub><span class="var">Nom</span></sub> ( <span class="var">P</span> ⋈ σ<sub><span class="var">Type</span> = Feu</sub> ( <span class="var">PT</span> ) )
                        </p>
                    </section>
                    <section>
                        <p>Une requête peut aussi être optimisée grâce à des <mark>index</mark> sur les tables.</p>
                        <table class="fragment">
                            <tr>
                                <th>Type d'index</th>
                                <th>Complexité</th>
                            </tr>
                            <tr>
                                <td>table de hachage</td>
                                <td>recherche d'élément en O(1)</td>
                            </tr>
                            <tr>
                                <td>B-arbre</td>
                                <td>recherche d'élément en O(log<sub>2</sub>(n))</td>
                            </tr>
                        </table>
                    </section>
                </section>
                <section>
                    <h4>Pourquoi "pas seulement" SQL ?</h4>
                    <section>
                        <p>
                            SQL est de loin le langage de requête le plus utilisé dans les SI.
                            
                        </p>
                        <p class="fragment note">
                            En 2020, <a href="https://en.wikipedia.org/wiki/Oracle_Corporation">Oracle</a> avait un chiffre d'affaire 100 fois plus élevé que <a href="https://en.wikipedia.org/wiki/MongoDB_Inc.">MongoDB</a>, le principal fournisseur de solutions NoSQL.
                        </p>
                    </section>
                    <section>
                        <p>
                            Le modèle relationnel est de loin le plus établi en informatique théorique.
                        </p>
                        <p class="fragment note">
                            Les travaux <a href="https://en.wikipedia.org/wiki/List_of_important_publications_in_computer_science#Databases">les plus significatifs en base de données</a> sont ceux de E. F. Codd, le concepteur du modèle relationnel.
                        </p>
                    </section>
                    <section>
                        <p>Mais...</p>
                    </section>
                    <section>
                        <figure>
                            <svg style="width: 75%;" version="1.1" viewBox="0 0 1024 683">
                                <image href="../misc/nosql-intro/nosql-debrief-2009.jpg"/>
                                <text class="fragment" style="fill: white; stroke: black; text-align: center; font-weight: bold; font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif; font-size: 80px;">
                                    <tspan x="20" y="120" textLength="800">RELATIONAL DATABASES</tspan>
                                    <tspan x="20" y="200" textLength="800">GIVE YOU TOO MUCH</tspan>
                                </text>
                                <g class="fragment">
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="30" y="400" />
                                        <image href="../misc/nosql-intro/logo-hbase.png" width="300" height="100" x="30" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="360" y="400" />
                                        <image href="../misc/nosql-intro/logo-dynamodb.png" width="300" height="100" x="360" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="690" y="400" />
                                        <image href="../misc/nosql-intro/logo-google-cloud.png" width="300" height="100" x="690" y="400" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="30" y="520" />
                                        <image href="../misc/nosql-intro/logo-couchdb.png" width="300" height="100" x="30" y="520" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="360" y="520" />
                                        <image href="../misc/nosql-intro/logo-mongodb.png" width="300" height="100" x="360" y="520" />
                                    </g>
                                    <g>
                                        <rect style="fill:white; fill-opacity:0.75;" width="300" height="100" x="690" y="520" />
                                        <image href="../misc/nosql-intro/logo-cassandra.png" width="300" height="100" x="690" y="520" />
                                    </g>
                                </g>
                            </svg>
                            <figcaption><a href="https://web.archive.org/web/20090927183845/http://blog.oskarsson.nu/2009/06/nosql-debrief.html">NoSQL community meeting</a>, San Francisco, 2009</figcaption>
                        </figure>
                    </section>
                    <section>
                        <q>
                            Relational databases force you to <mark>twist your object data</mark> to fit a RDBMS [relational database management system].
                        </q>
                    </section>
                    <section>
                        <q>
                            Web 2.0 companies can take chances and they need <mark>scalability</mark>.
                        </q>
                    </section>
                    <section>
                        <q>
                            Oracle would tell you that with the right degree of hardware and the right configuration, you can achieve the same scalability. But <mark>at what cost</mark>?
                        </q>
                    </section>
                    <section>
                        <p>
                            Les premières bases de données NoSQL ont été conçues pour être :
                        </p>
                        <ul>
                            <li class="fragment">massivement distribuées</li>
                            <li class="fragment">sur des serveurs abordables</li>
                            <li class="fragment">et accessibles à distance</li>
                        </ul>
                    </section>
                    <section>
                        <p>SQL garantit la cohérence des données (si leur schéma est normalisé).</p>
                        <p class="fragment">
                            Or, toute base de données <mark>distribuée</mark> ne peut être en même temps<br>
                            <mark>cohérente</mark> et <mark>accessible</mark>.
                        </p>
                    </section>
                    <section>
                        <p>
                            C'est le théorème <b>CAP</b>.
                        </p>
                        <table class="fragment">
                            <tr>
                                <th>Cohérence</th>
                                <td>les données requêtées sur une partition ne sont jamais obsolètes.</td>
                            </tr>
                            <tr>
                                <th>Accessibilité</th>
                                <td>une requête sur une partition retourne toujours un résultat.</td>
                            </tr>
                            <tr>
                                <th>Partitionnement tolérant aux fautes</th>
                                <td>une requête sur une partition retourne parfois une erreur.</td>
                            </tr>
                        </table>
                    </section>
                    <section>
                        <p>
                            Les bases de données NoSQL utilisent des <mark>schémas dénormalisés</mark> pour garantir un accès rapide et à distance aux données.
                        </p>
                    </section>
                    <section>
                        <p>
                            Par extension, d'autres bases de données ont été labelisées « NoSQL ».
                        </p>
                        <p class="fragment">
                            Ces bases de données offrent des <mark>langages de requête alternatifs</mark> à SQL.
                        </p>
                    </section>
                    <section>
                        <p>
                            Plusieurs modèles de données NoSQL (co)existent.
                        </p>
                        <table class="fragment">
                            <thead>
                                <tr>
                                    <th>Déf. de NoSQL</th>
                                    <th>Modèle de données</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3">stricte</td>
                                    <td>paire clé-valeur</td>
                                </tr>
                                <tr>
                                    <td>document</td>
                                </tr>
                                <tr>
                                    <td>à colonne extensible (ou « large »)</td>
                                </tr>
                                <tr>
                                    <td rowspan="2">étendue</td>
                                    <td>en graphe</td>
                                </tr>
                                <tr>
                                    <td>RDF <span style="font-size: 0.5em;">(Resource Description Framework)</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                </section>
                <section>
                    <h4>Clés-valeurs</h4>
                    <section>
                        <p>DynamoDB, Tokyo/Kyoto Cabinet, Redis</p>
                        <p>Schéma extrêmement simple</p>
                        <p>(key, value)</p>
                        <p>primary key: (key, value)</p>
                        <p>index on (key)</p>
                    </section>
                </section>
                <section>
                    <h4>Documents</h4>
                    <section>
                        <p>MongoDB, CouchDB</p>
                    </section>
                </section>
                <section>
                    <h4>Colonnes</h4>
                    <section>
                        <p>Bigtable, HBase, Cassandra</p>
                        <p>(key, column, timestamp)</p>
                        <p>primary key: (key, column, timestamp)</p>
                        <p>index on (key)</p>
                    </section>
                </section>
                <section>
                    <h4>Graphes</h4>
                    <section>
                        <p>Neo4J, Amazon Neptune</p>
                        <p>node(id, label, property_id), edge(id, label, property_id), connection(src_id, edge_id, target_id)</p>
                        <p>index on node(id), edge(id)</p>
                    </section>
                </section>
                <section>
                    <h4>RDF</h4>
                    <section>
                        <p>Virtuoso, AllegroGraph, Stardog, GraphDB, Jena (Fuseki), Amazon Neptune</p>
                        <p>(subject, predicate, object)</p>
                        <p>primary key: (s, p, o)</p>
                        <p>index on...</p>
                    </section>
                </section>
                <section>
                    <h4>Résumé</h4>
                    <section>
                        <p>
                            NoSQL en X points :
                        </p>
                        <ul>
                            <li>une base de données NoSQL utilise un schéma dénormalisé.</li>
                            <li>il existe cinq modèles de données principaux.</li>
                            <li>...</li>
                        </ul>
                    </section>
                </section>
                <section>
                    <h4>Pour aller plus loin...</h4>
                    <section>
                        <ul style="font-size: 0.5em;">
                            <li>Eric Lai (2009), <a href="https://www.computerworld.com/article/2526317/no-to-sql--anti-database-movement-gains-steam.html">No to SQL? Anti-database movement gains steam,</a> Computerworld.</li>
                            <li>Christof Strauch (2011), <a>NoSQL Databases</a>, Hochschule der Medien Stuttgart.</li>
                            <li>Seth Gilbert and Nancy Lynch (2002), <a href="https://dl.acm.org/doi/abs/10.1145/564585.564601">Brewer's conjecture and the feasibility of consistent, available, partition-tolerant web services</a>, ACM SIGACT News.</li>
                            <li>John F. Sowa (2007), <a href="https://ieeexplore.ieee.org/document/4136864">Fads and Fallacies about Logic</a>, IEEE Intelligent Systems.</li>
                            <!-- discute SQL comme langage... universel. NoSQL intéressant théoriquement ? -->
                        </ul>
                    </section>
                </section>
            </div>
        </div>

		<script src="../js/slides.js"></script>
		<script src="../js/slides-code.js"></script>
		<script>
			Reveal.initialize({
				hash: true,
				plugins: [ RevealHighlight ]
			});
		</script>
    </body>
</html>